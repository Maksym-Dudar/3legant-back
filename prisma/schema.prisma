// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int           @id @default(autoincrement())
  email             String        @unique
  password          String
  otp               Int?
  expareOtp         DateTime?     @map("expare_otp")
  firstName         String        @map("first_name")
  lastName          String?       @map("last_name")
  avatar            String?
  createdAt         DateTime      @default(now()) @map("created_at")
  updatedAt         DateTime      @updatedAt      @map("updated_at")

  comments          Comment[]
  Address           Addres[]
  orders            Order[]
}

model Product{
  id                Int           @id @default(autoincrement())
  productGroupId    Int           @map("product_group_id")
  isNew             Boolean       @map("is_new")
  offerExpires      DateTime?     @map("offer_expires")
  measurements      String
  sale              Float
  price             Float
  rating            Int
  reviews           Int
  quantityWarehouse Int            @map("quantity_warehouse")
  createdAt         DateTime       @default(now()) @map("created_at")
  updatedAt         DateTime?      @updatedAt  @map("updated_at")
  color             String  
  description       String

  image             String[]
  category          Category[]

  comment           Comment[]
  orders            Order[]
  productGroup      ProductGroup   @relation(fields: [productGroupId], references: [id])
}

model ProductGroup{
  id                Int           @id @default(autoincrement())
  title             String

  product           Product[]
}

model Addres{
  id                Int             @id @default(autoincrement())
  userId            Int             @map("user_id")
  firstName         String          @map("first_name")
	lastName          String          @map("last_name")
	phoneNumber       String          @map("phone_number")
	email             String
  country           String
	state             String
	city              String
	street            String
	buildingNumber    String          @map("building_number")
	zipCode           String          @map("zip_code")

  orders            Order[]
  user              User            @relation(fields: [userId], references: [id])

}

model Order{
  id                Int             @id @default(autoincrement())
  userId            Int             @map("user_id")
  addressId         Int             @map("address_id")
  productId         Int             @map("product_id")
  price             Int
  createdAt         DateTime        @default(now()) @map("created_at")
  status            OrderStatus

  user              User            @relation(fields: [userId], references: [id])
  address           Addres          @relation(fields: [addressId], references: [id])
  product           Product         @relation(fields: [productId], references: [id])

}


model Comment {
  id                Int             @id @default(autoincrement())
  userId            Int             @map("user_id")
  productId         Int             @map("product_id")
  rating            Int
  text              String

  product           Product         @relation(fields: [productId], references: [id])
  user              User            @relation(fields: [userId], references: [id])
}

enum Category {
  LIVING_ROOM                       @map("living_room")
  BEDROOM                           @map("bedroom")
  KITCHEN                           @map("kitchen")
  BATHROOM                          @map("bathroom")
  OFFICE                            @map("office")
}

enum OrderStatus {
  PENDING                           @map("pending")          // замовлення створено, очікує підтвердження
  CONFIRMED                         @map("confirmed")        // підтверджено менеджером або системою
  PROCESSING                        @map("processing")       // готується до відправки
  SHIPPED                           @map("shipped")          // передано службі доставки
  DELIVERED                         @map("delivered")        // доставлено клієнту
  COMPLETED                         @map("completed")        // успішно завершено (оплачено, отримано)
  CANCELLED                         @map("cancelled")        // скасовано клієнтом або системою
  RETURNED                          @map("returned")         // повернено після доставки
  FAILED                            @map("failed")           // не вдалося обробити (наприклад, помилка оплати)
}